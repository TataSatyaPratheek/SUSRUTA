<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="500" fill="#f8f9fa" />
  
  <!-- Title -->
  <text x="400" y="30" font-family="Arial" font-size="20" font-weight="bold" text-anchor="middle" fill="#333">Memory-Optimized Processing Pipeline for M1 Air (8GB)</text>
  
  <!-- Memory Bar -->
  <rect x="60" y="60" width="680" height="30" rx="5" fill="#e6e6e6" stroke="#333" stroke-width="1" />
  <text x="400" y="80" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">Available Memory (8GB)</text>
  
  <!-- Stage 1: Preprocessing -->
  <g>
    <rect x="60" y="110" width="680" height="80" rx="10" fill="#e1f5fe" stroke="#0288d1" stroke-width="2" />
    <text x="110" y="135" font-family="Arial" font-size="16" font-weight="bold" fill="#0288d1">Stage 1: Data Preprocessing</text>
    
    <!-- Memory usage -->
    <rect x="80" y="150" width="200" height="20" rx="3" fill="#64b5f6" />
    <text x="190" y="165" font-family="Arial" font-size="12" text-anchor="middle" fill="white">MRI Processing (2.5GB)</text>
    
    <text x="560" y="150" font-family="Arial" font-size="12" fill="#0288d1">• Chunk-based processing of MRI volumes</text>
    <text x="560" y="170" font-family="Arial" font-size="12" fill="#0288d1">• Sequential file processing</text>
  </g>
  
  <!-- Stage 2: Graph Construction -->
  <g>
    <rect x="60" y="200" width="680" height="80" rx="10" fill="#e8f5e9" stroke="#388e3c" stroke-width="2" />
    <text x="110" y="225" font-family="Arial" font-size="16" font-weight="bold" fill="#388e3c">Stage 2: Graph Construction</text>
    
    <!-- Memory usage -->
    <rect x="80" y="240" width="300" height="20" rx="3" fill="#81c784" />
    <text x="230" y="255" font-family="Arial" font-size="12" text-anchor="middle" fill="white">Knowledge Graph Construction (3.8GB)</text>
    
    <text x="560" y="240" font-family="Arial" font-size="12" fill="#388e3c">• Incremental node/edge addition</text>
    <text x="560" y="260" font-family="Arial" font-size="12" fill="#388e3c">• Sparse graph representation</text>
  </g>
  
  <!-- Stage 3: Model Training -->
  <g>
    <rect x="60" y="290" width="680" height="80" rx="10" fill="#fff3e0" stroke="#f57c00" stroke-width="2" />
    <text x="110" y="315" font-family="Arial" font-size="16" font-weight="bold" fill="#f57c00">Stage 3: GNN Training</text>
    
    <!-- Memory usage -->
    <rect x="80" y="330" width="480" height="20" rx="3" fill="#ffb74d" />
    <text x="320" y="345" font-family="Arial" font-size="12" text-anchor="middle" fill="white">Model Training with Mini-batches (6GB)</text>
    
    <text x="560" y="320" font-family="Arial" font-size="12" fill="#f57c00">• Neighborhood sampling</text>
    <text x="560" y="345" font-family="Arial" font-size="12" fill="#f57c00">• Gradient checkpointing</text>
  </g>
  
  <!-- Stage 4: Inference -->
  <g>
    <rect x="60" y="380" width="680" height="80" rx="10" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" />
    <text x="110" y="405" font-family="Arial" font-size="16" font-weight="bold" fill="#7b1fa2">Stage 4: Inference and Explanation</text>
    
    <!-- Memory usage -->
    <rect x="80" y="420" width="350" height="20" rx="3" fill="#ba68c8" />
    <text x="255" y="435" font-family="Arial" font-size="12" text-anchor="middle" fill="white">Inference and Visualization (4.5GB)</text>
    
    <text x="560" y="425" font-family="Arial" font-size="12" fill="#7b1fa2">• Treatment simulation</text>
    <text x="560" y="435" font-family="Arial" font-size="12" fill="#7b1fa2">• Model pruning</text>
    <text x="560" y="445" font-family="Arial" font-size="12" fill="#7b1fa2">• Progressive rendering</text>
  </g>
  
  <!-- Memory Optimization Techniques -->
  <g>
    <line x1="60" y1="470" x2="740" y2="470" stroke="#333" stroke-width="1" stroke-dasharray="5,5" />
    <text x="400" y="490" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">Global Optimizations: Explicit GC Calls • Mixed Precision • Tensor Sharing • Memory Monitoring</text>
  </g>
</svg>